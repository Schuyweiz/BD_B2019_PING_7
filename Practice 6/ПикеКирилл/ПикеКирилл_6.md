```sql
-- Задание 1.
select extract(year from players.birthdate) as birth_year,
       count(distinct players.player_id)    as players_on_given_year,
       count(players.birthdate)             as gold_medals_total
from players
         join results on players.player_id = results.player_id and results.medal = 'GOLD'
         join events on events.event_id = results.event_id
         join olympics on events.olympic_id = olympics.olympic_id and olympics.olympic_id = 'ATH2004'
group by birth_year;

-- Задание 2.
select events.event_id
from events
         join results on events.event_id = results.event_id
    and events.is_team_event = 0
    and results.medal = 'GOLD'
group by events.event_id
having count(*) > 1;


--Задание 3.
select distinct players.name, olympics.olympic_id
from players
         join results on players.player_id = results.player_id
    and results.medal in ('BRONZE', 'SILVER', 'GOLD')
         join events on results.event_id = events.event_id
         join olympics on olympics.olympic_id = events.olympic_id
group by players.name, olympics.olympic_id;


--Задание 4
-- Учитывая формулировку задачи, можно было упрстить до просто самого 
-- большого количества таких участников. Но если вдруг не подходит и нужны именно соотношения, 
-- то перепишу.
select c.country_id
from players
         join countries c on c.country_id = players.country_id
where players.name ~ '^[EUIOA]\S+'
group by c.country_id
order by count(*) desc
    fetch first rows
with ties;


--Задание 5
select distinct countries.country_id,
                round((count(*) over (partition by players.country_id))::numeric
                          / countries.population, 12) as medals_to_pop
from countries
         join players on countries.country_id = players.country_id
         join results on players.player_id = results.player_id
         join events on results.event_id = events.event_id and events.is_team_event = 1
         join olympics on events.olympic_id = olympics.olympic_id and events.olympic_id = 'SYD2000'
order by medals_to_pop desc
    fetch first 5 rows
with ties;
```